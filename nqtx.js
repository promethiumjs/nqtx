let $15882dbcd04d9f27$var$currentEntity,$15882dbcd04d9f27$var$getCurrentStoreMethod,$15882dbcd04d9f27$var$getCurrentStoreIdMethod,$15882dbcd04d9f27$var$renderComponentMethod,$15882dbcd04d9f27$var$getPreventMultipleRendersMethod,$15882dbcd04d9f27$var$setPreventMultipleRendersMethod;function $15882dbcd04d9f27$export$33b9e1ccb5643ac8(entity){$15882dbcd04d9f27$var$currentEntity=entity}function $15882dbcd04d9f27$export$5676a8a1d49c85be(){return $15882dbcd04d9f27$var$currentEntity}function $15882dbcd04d9f27$export$9d75f3e1a7e94aee(storeId){return $15882dbcd04d9f27$var$getCurrentStoreMethod(storeId)}function $15882dbcd04d9f27$export$9e78cbb868ddafad(){return $15882dbcd04d9f27$var$getCurrentStoreIdMethod()}function $15882dbcd04d9f27$export$fa7f552cb3a457a6(storeId){$15882dbcd04d9f27$var$renderComponentMethod(storeId)}function $15882dbcd04d9f27$export$e7f1d62916683ee7(){return $15882dbcd04d9f27$var$getPreventMultipleRendersMethod}function $15882dbcd04d9f27$export$743647d42396ef87(boolean){$15882dbcd04d9f27$var$setPreventMultipleRendersMethod(boolean)}function $15882dbcd04d9f27$export$6ceec5925def9744({getCurrentStore:getCurrentStore,getCurrentStoreId:getCurrentStoreId,renderComponent:renderComponent,getPreventMultipleRenders:getPreventMultipleRenders,setPreventMultipleRenders:setPreventMultipleRenders}){$15882dbcd04d9f27$var$getCurrentStoreMethod=getCurrentStore,$15882dbcd04d9f27$var$getCurrentStoreIdMethod=getCurrentStoreId,$15882dbcd04d9f27$var$renderComponentMethod=renderComponent,$15882dbcd04d9f27$var$getPreventMultipleRendersMethod=getPreventMultipleRenders,$15882dbcd04d9f27$var$setPreventMultipleRendersMethod=setPreventMultipleRenders}function $902aaab0efe07d29$export$2e2bcd8739ae039({particleId:particleId,newState:newState}){const _particle=this._particles[particleId],states=this.particles.states,derivativeSubs=this.particles.derivativeSubs,componentSubs=this.particles.componentSubs,otherSubs=this.particles.otherSubs,otherSubs_instant=this.particles.otherSubs_instant;void 0!==_particle.previous&&(_particle.previous=_particle.state),void 0!==newState?(_particle.state=newState,states[particleId]=newState):(_particle.state=null,states[particleId]=null),$15882dbcd04d9f27$export$743647d42396ef87(!0),otherSubs_instant[particleId]&&otherSubs_instant[particleId].forEach((listener=>listener(newState,_particle.previous))),derivativeSubs[particleId]&&derivativeSubs[particleId].forEach((derivativeId=>this.update({derivativeId:derivativeId}))),componentSubs[particleId]&&componentSubs[particleId].forEach((storeId=>$15882dbcd04d9f27$export$fa7f552cb3a457a6(storeId))),otherSubs[particleId]&&setTimeout((()=>otherSubs[particleId].forEach((listener=>listener(newState,_particle.previous))))),$15882dbcd04d9f27$export$743647d42396ef87(!1)}function $64f44bd8a4ac287d$export$2e2bcd8739ae039({particleId:particleId,derivativeId:derivativeId,firstTime:firstTime}){const states=this.particles.states;if(void 0===states[particleId])throw console.error(`The particle you are trying to access with id: ${particleId} doesn't exist`),new Error(`Cannot access state of particle: "${particleId}"`);if(firstTime){const derivativeSubs=this.particles.derivativeSubs;if(derivativeSubs[particleId]){if(derivativeSubs[particleId].includes(derivativeId))return states[particleId];derivativeSubs[particleId].push(derivativeId)}else derivativeSubs[particleId]=[],derivativeSubs[particleId].push(derivativeId);const particleSubs=this.derivatives.particleSubs,unsubscribe=()=>{try{const index=derivativeSubs[particleId].indexOf(derivativeId);derivativeSubs[particleId].splice(index,1)}catch(err){}};particleSubs[derivativeId]||(particleSubs[derivativeId]=[]),particleSubs[derivativeId].push(unsubscribe)}return states[particleId]}function $4f9c79783558702f$export$2e2bcd8739ae039({particleId:particleId,derivativeId:derivativeId,firstTime:firstTime}){const _particle=this._particles[particleId];if(void 0===_particle.previous)throw console.error(`The particle you are trying to access with id: ${particleId} either \n        doesn't exist or doesn't have it's "previousState" flag set to true`),new Error(`Cannot access previous state of particle: "${particleId}"`);if(firstTime){const derivativeSubs=this.particles.derivativeSubs;if(derivativeSubs[particleId]){if(derivativeSubs[particleId].includes(derivativeId))return _particle.previous;derivativeSubs[particleId].push(derivativeId)}else derivativeSubs[particleId]=[],derivativeSubs[particleId].push(derivativeId);const particleSubs=this.derivatives.particleSubs,unsubscribe=()=>{try{const index=derivativeSubs[particleId].indexOf(derivativeId);derivativeSubs[particleId].splice(index,1)}catch(err){}};particleSubs[derivativeId]||(particleSubs[derivativeId]=[]),particleSubs[derivativeId].push(unsubscribe)}return _particle.previous}function $f79f91d23d669bcf$export$2e2bcd8739ae039({derivativeId:derivativeId}){const _derivative=this._derivatives[derivativeId],states=this.derivatives.states,transforms=this.derivatives.transforms,componentSubs=this.derivatives.componentSubs,otherSubs=this.derivatives.otherSubs,otherSubs_instant=this.derivatives.otherSubs_instant;let newState;void 0!==_derivative.previous&&(_derivative.previous=_derivative.state);try{newState=transforms[derivativeId]({get:particleId=>this.get({particleId:particleId,derivativeId:derivativeId}),getPrevious:particleId=>this.getPrevious({particleId:particleId}),state:states[derivativeId]})}catch(err){newState=null}void 0!==newState?(_derivative.state=newState,states[derivativeId]=newState):(_derivative.state=null,states[derivativeId]=null),otherSubs_instant[derivativeId]&&otherSubs_instant[derivativeId].forEach((listener=>listener(newState,_derivative.previous))),componentSubs[derivativeId]&&componentSubs[derivativeId].forEach((storeId=>$15882dbcd04d9f27$export$fa7f552cb3a457a6(storeId))),otherSubs[derivativeId]&&setTimeout((()=>otherSubs[derivativeId].forEach((listener=>listener(newState,_derivative.previous)))))}function $aa4dfc1f0c762d24$export$2e2bcd8739ae039({id:id,storeId:storeId}){if(!this._particles[id])throw console.error(`You are trying to access a particle with id: "${id}" that doesn't yet exist`),new Error(`Particle: "${id}" is not accessible`);if(storeId){const componentSubs=this.particles.componentSubs;componentSubs[id]||(componentSubs[id]=[]),componentSubs[id].push(storeId);const unsubscribe=()=>{try{const index=componentSubs[id].indexOf(storeId);componentSubs[id].splice(index,1)}catch(err){}};return[this._particles[id],unsubscribe]}return this._particles[id]}function $bb1f9ff5f7d19e8e$export$2e2bcd8739ae039({id:id,initialState:initialState,mutator:mutator,previousState:previousState}){const states=this.particles.states,mutators=this.particles.mutators,derivativeSubs=this.particles.derivativeSubs,componentSubs=this.particles.componentSubs,otherSubs=this.particles.otherSubs,otherSubs_instant=this.particles.otherSubs_instant;void 0!==initialState?states[id]=initialState:void 0===states[id]&&(states[id]=null),mutator&&(mutators[id]=mutator),this._particles[id]={state:states[id],get:()=>states[id],mutate:(mutation,payload)=>{this.set({particleId:id,newState:mutators[id][mutation]({state:states[id],payload:payload})})},set:newState=>this.set({particleId:id,newState:newState}),subscribe:listener=>(otherSubs[id]||(otherSubs[id]=[]),otherSubs[id].push(listener),()=>{try{const index=otherSubs[id].indexOf(listener);otherSubs[id].splice(index,1)}catch(err){}}),subscribe_instant:listener=>(otherSubs_instant[id]||(otherSubs_instant[id]=[]),otherSubs_instant[id].push(listener),()=>{try{const index=otherSubs_instant[id].indexOf(listener);otherSubs_instant[id].splice(index,1)}catch(err){}}),detonate:()=>{this._particles[id].state=null,this._particles[id].previous=null,this._particles[id].get=null,this._particles[id].mutate=null,this._particles[id].set=null,this._particles[id].subscribe=null,this._particles[id].subscribe_instant=null,this._particles[id].detonate=null,delete this._particles[id],delete states[id],delete mutators[id],delete derivativeSubs[id],delete componentSubs[id],delete otherSubs[id],delete otherSubs_instant[id]}},previousState&&(this._particles[id].previous=states[id])}function $54f4621744d73147$export$2e2bcd8739ae039({id:id,initialState:initialState,transform:transform,previousState:previousState}){const states=this.derivatives.states,transforms=this.derivatives.transforms,particleSubs=this.derivatives.particleSubs,componentSubs=this.derivatives.componentSubs,otherSubs=this.derivatives.otherSubs,otherSubs_instant=this.derivatives.otherSubs_instant;if(transform&&(transforms[id]=transform),void 0!==initialState)states[id]=initialState;else if(void 0===states[id]){try{states[id]=transforms[id]({get:particleId=>this.get({particleId:particleId,derivativeId:id,firstTime:!0}),getPrevious:particleId=>this.getPrevious({particleId:particleId,derivativeId:id,firstTime:!0})})}catch(err){states[id]=null}void 0===states[id]&&states[id]}this._derivatives[id]={state:states[id],get:payload=>transforms[id]({get:particleId=>this.get({particleId:particleId,derivativeId:id}),getPrevious:particleId=>this.getPrevious({particleId:particleId,derivativeId:id}),payload:payload,state:states[id]}),subscribe:listener=>(otherSubs[id]||(otherSubs[id]=[]),otherSubs[id].push(listener),()=>{try{const index=otherSubs[id].indexOf(listener);otherSubs[id].splice(index,1)}catch(err){}}),subscribe_instant:listener=>(otherSubs_instant[id]||(otherSubs_instant[id]=[]),otherSubs_instant[id].push(listener),()=>{try{const index=otherSubs_instant[id].indexOf(listener);otherSubs_instant[id].splice(index,1)}catch(err){}}),detonate:()=>{this._derivatives[id].state=null,this._derivatives[id].previous=null,this._derivatives[id].get=null,this._derivatives[id].subscribe=null,this._derivatives[id].subscribe_instant=null,this._derivatives[id].detonate=null,particleSubs[id].forEach((unsubscribe=>unsubscribe())),delete this._derivatives[id],delete states[id],delete transforms[id],delete particleSubs[id],delete componentSubs[id],delete otherSubs[id]}},previousState&&(this._derivatives[id].previous=states[id])}function $e59d7b2581ef6c73$export$2e2bcd8739ae039({id:id,storeId:storeId}){if(!this._derivatives[id])throw console.error(`You are trying to access a derivative with id: "${id}" that doesn't yet exist`),new Error(`Derivative: "${id}" is not accessible`);if(storeId){const componentSubs=this.derivatives.componentSubs;componentSubs[id]||(componentSubs[id]=[]),componentSubs[id].push(storeId);const unsubscribe=()=>{try{const index=componentSubs[id].indexOf(storeId);componentSubs[id].splice(index,1)}catch(err){}};return[this._derivatives[id],unsubscribe]}return this._derivatives[id]}function $dcf105ea6755ba11$export$2e2bcd8739ae039({id:id}){if(!this._triggers[id])throw console.error(`You are trying to access a trigger with id: "${id}" that doesn't yet exist`),new Error(`Trigger: "${id}" is not accessible`);return this._triggers[id]}function $72a4bf13730488a1$export$2e2bcd8739ae039({id:id,initialSubscriptions:initialSubscriptions}){const subscriptions=this.triggers.subscriptions;subscriptions[id]=initialSubscriptions||[],this._triggers[id]={invoke:(...payload)=>{subscriptions[id].forEach((listener=>listener(...payload)))},subscribe:listener=>(subscriptions[id].push(listener),()=>{try{const index=subscriptions[id].indexOf(listener);subscriptions[id].splice(index,1)}catch(err){}}),detonate:()=>{this._triggers[id].invoke=null,this._triggers[id].subscribe=null,delete this._triggers[id],delete subscriptions[id]}}}function $f622ad01ce93fdf1$export$2e2bcd8739ae039({id:id,initialState:initialState,mutator:mutator,overwrite:overwrite,previousState:previousState}){if(this._particles[id])return this.getParticle({id:id});const states=this.particles.states;return states[id]&&states[id]&&!overwrite?this.setParticle({id:id,mutator:mutator,previousState:previousState}):this.setParticle({id:id,initialState:initialState,mutator:mutator,previousState:previousState}),this.getParticle({id:id})}function $27b0167c3fafa3b0$export$2e2bcd8739ae039({id:id,initialState:initialState,transform:transform,overwrite:overwrite,previousState:previousState}){if(this._derivatives[id])return this.getDerivative({id:id});const states=this.derivatives.states;return states[id]&&states[id]&&!overwrite?this.setDerivative({id:id,transform:transform,previousState:previousState}):this.setDerivative({id:id,initialState:initialState,transform:transform,previousState:previousState}),this.getDerivative({id:id})}function $e3cdf8d044a86bbf$export$2e2bcd8739ae039({id:id,initialSubscriptions:initialSubscriptions}){return this._triggers[id]||this.setTrigger({id:id,initialSubscriptions:initialSubscriptions}),this.getTrigger({id:id})}class $97020ee417fa4c70$export$2e2bcd8739ae039{constructor(initial){this.particles={states:initial&&initial.particleStates||{},mutators:{},derivativeSubs:{},componentSubs:{},otherSubs:{},otherSubs_instant:{}},this._particles={},this.derivatives={states:initial&&initial.derivativeStates||{},transforms:{},particleSubs:{},componentSubs:{},otherSubs:{},otherSubs_instant:{}},this._derivatives={},this.triggers={subscriptions:{}},this._triggers={},this.particle=$f622ad01ce93fdf1$export$2e2bcd8739ae039.bind(this),this.derivative=$27b0167c3fafa3b0$export$2e2bcd8739ae039.bind(this),this.trigger=$e3cdf8d044a86bbf$export$2e2bcd8739ae039.bind(this),this.set=$902aaab0efe07d29$export$2e2bcd8739ae039.bind(this),this.get=$64f44bd8a4ac287d$export$2e2bcd8739ae039.bind(this),this.getPrevious=$4f9c79783558702f$export$2e2bcd8739ae039.bind(this),this.update=$f79f91d23d669bcf$export$2e2bcd8739ae039.bind(this),this.getParticle=$aa4dfc1f0c762d24$export$2e2bcd8739ae039.bind(this),this.setParticle=$bb1f9ff5f7d19e8e$export$2e2bcd8739ae039.bind(this),this.getDerivative=$e59d7b2581ef6c73$export$2e2bcd8739ae039.bind(this),this.setDerivative=$54f4621744d73147$export$2e2bcd8739ae039.bind(this),this.getTrigger=$dcf105ea6755ba11$export$2e2bcd8739ae039.bind(this),this.setTrigger=$72a4bf13730488a1$export$2e2bcd8739ae039.bind(this)}static create(initialParticleStates){const entity=new $97020ee417fa4c70$export$2e2bcd8739ae039(initialParticleStates);return $15882dbcd04d9f27$export$33b9e1ccb5643ac8(entity),entity}addAdaptationMethods(methods){$15882dbcd04d9f27$export$6ceec5925def9744(methods)}getParticleStates(){return this.particles.states}getDerivativeStates(){return this.derivatives.states}}function $ece177b0c5651317$var$adaptEntity(){return $15882dbcd04d9f27$export$5676a8a1d49c85be()}var $ece177b0c5651317$export$2e2bcd8739ae039=$ece177b0c5651317$var$adaptEntity;function $9a74da07d11fdf6d$var$adaptParticle(id){const currentStore=$15882dbcd04d9f27$export$9d75f3e1a7e94aee(),currentStoreId=$15882dbcd04d9f27$export$9e78cbb868ddafad(),currentEntity=$15882dbcd04d9f27$export$5676a8a1d49c85be();if(currentStore&&!currentStore.particles&&(currentStore.particles=[],currentStore.currentAdaptationIds.particle=0,currentStore.particleCleanups=[],currentStore.currentAdaptationIds.particleCleanup=0),currentStore){if(!(currentStore.currentAdaptationIds.particle in currentStore.particles)){let particle=currentEntity.getParticle({id:id,storeId:currentStoreId});currentStore.particles[currentStore.currentAdaptationIds.particle]=[particle[0].state,particle[0]],currentStore.particleCleanups[currentStore.currentAdaptationIds.particleCleanup]=particle[1]}let particle0=currentStore.particles[currentStore.currentAdaptationIds.particle];return particle0[0]=particle0[1].state,currentStore.particles[currentStore.currentAdaptationIds.particle++]}throw new Error("adaptParticle() can only be used inside a Component or a Custom Adaptation.")}var $9a74da07d11fdf6d$export$2e2bcd8739ae039=$9a74da07d11fdf6d$var$adaptParticle;function $843d76398a97f7ed$var$adaptParticleObject(id){const currentStore=$15882dbcd04d9f27$export$9d75f3e1a7e94aee(),currentEntity=($15882dbcd04d9f27$export$9e78cbb868ddafad(),$15882dbcd04d9f27$export$5676a8a1d49c85be());if(currentStore&&!currentStore.particles&&(currentStore.particles=[],currentStore.currentAdaptationIds.particle=0),currentStore){if(!(currentStore.currentAdaptationIds.particle in currentStore.particles)){let particle=currentEntity.getParticle({id:id});currentStore.particles[currentStore.currentAdaptationIds.particle]=particle}return currentStore.particles[currentStore.currentAdaptationIds.particle++]}throw new Error("adaptParticleObject() can only be used inside a Component or a Custom Adaptation.")}var $843d76398a97f7ed$export$2e2bcd8739ae039=$843d76398a97f7ed$var$adaptParticleObject;function $849cb7c2680d1324$var$adaptDerivative(id){const currentStore=$15882dbcd04d9f27$export$9d75f3e1a7e94aee(),currentStoreId=$15882dbcd04d9f27$export$9e78cbb868ddafad(),currentEntity=$15882dbcd04d9f27$export$5676a8a1d49c85be();if(currentStore&&!currentStore.derivatives&&(currentStore.derivatives=[],currentStore.currentAdaptationIds.derivative=0,currentStore.derivativeCleanups=[],currentStore.currentAdaptationIds.derivativeCleanup=0),currentStore){if(!(currentStore.currentAdaptationIds.derivative in currentStore.derivatives)){let derivative=currentEntity.getDerivative({id:id,storeId:currentStoreId});currentStore.derivatives[currentStore.currentAdaptationIds.derivative]=[derivative[0].state,derivative[0]],currentStore.derivativeCleanups[currentStore.currentAdaptationIds.derivativeCleanup]=derivative[1]}let derivative0=currentStore.derivatives[currentStore.currentAdaptationIds.derivative];return derivative0[0]=derivative0[1].state,currentStore.derivatives[currentStore.currentAdaptationIds.derivative++]}throw new Error("adaptDerivative() can only be used inside a Component or a Custom Adaptation.")}var $849cb7c2680d1324$export$2e2bcd8739ae039=$849cb7c2680d1324$var$adaptDerivative;function $6b02f44ed830e832$var$adaptDerivativeObject(id){const currentStore=$15882dbcd04d9f27$export$9d75f3e1a7e94aee(),currentEntity=($15882dbcd04d9f27$export$9e78cbb868ddafad(),$15882dbcd04d9f27$export$5676a8a1d49c85be());if(currentStore&&!currentStore.derivatives&&(currentStore.derivatives=[],currentStore.currentAdaptationIds.derivative=0,currentStore.derivativeCleanups=[],currentStore.currentAdaptationIds.derivativeCleanup=0),currentStore){if(!(currentStore.currentAdaptationIds.derivative in currentStore.derivatives)){let derivative=currentEntity.getDerivative({id:id});currentStore.derivatives[currentStore.currentAdaptationIds.derivative]=derivative}return currentStore.derivatives[currentStore.currentAdaptationIds.derivative++]}throw new Error("adaptDerivativeObject() can only be used inside a Component or a Custom Adaptation.")}var $6b02f44ed830e832$export$2e2bcd8739ae039=$6b02f44ed830e832$var$adaptDerivativeObject;function $926bb7bcfd7aed9a$var$adaptTrigger(id){const currentStore=$15882dbcd04d9f27$export$9d75f3e1a7e94aee(),currentEntity=($15882dbcd04d9f27$export$9e78cbb868ddafad(),$15882dbcd04d9f27$export$5676a8a1d49c85be());if(currentStore&&!currentStore.triggers&&(currentStore.triggers=[],currentStore.currentAdaptationIds.trigger=0),currentStore)return currentStore.currentAdaptationIds.trigger in currentStore.triggers||(currentStore.triggers[currentStore.currentAdaptationIds.trigger]=currentEntity.getTrigger({id:id})),currentStore.triggers[currentStore.currentAdaptationIds.trigger++];throw new Error("adaptTrigger() can only be used inside a Component or a Custom Adaptation.")}var $926bb7bcfd7aed9a$export$2e2bcd8739ae039=$926bb7bcfd7aed9a$var$adaptTrigger,$a40aa44e9b19fa09$export$2e2bcd8739ae039=$97020ee417fa4c70$export$2e2bcd8739ae039;export{$a40aa44e9b19fa09$export$2e2bcd8739ae039 as default,$926bb7bcfd7aed9a$export$2e2bcd8739ae039 as adaptTrigger,$ece177b0c5651317$export$2e2bcd8739ae039 as adaptEntity,$9a74da07d11fdf6d$export$2e2bcd8739ae039 as adaptParticle,$843d76398a97f7ed$export$2e2bcd8739ae039 as adaptParticleObject,$849cb7c2680d1324$export$2e2bcd8739ae039 as adaptDerivative,$6b02f44ed830e832$export$2e2bcd8739ae039 as adaptDerivativeObject};